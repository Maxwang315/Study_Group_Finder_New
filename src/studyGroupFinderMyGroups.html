<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>My Study Groups</title>
  <link rel="stylesheet" href="styles.css" />
</head>
<body>
  <header>
    <nav class="topnav">
      <a href="studyGroupFinderMain.html">Home</a>
      <a href="studyGroupFinderGroups.html">Browse</a>
      <a href="studyGroupFinderPost.html">Post a Group</a>
    </nav>
    <h1>My Study Groups</h1>
    <div class="user-context">
      <small>University:</small>
      <span class="badge" id="mygroups-university">Select your university on sign up</span>
    </div>
  </header>

  <main class="container">
    <!-- Section for groups the user has posted -->
    <section class="card">
      <h2>Groups I Posted</h2>
      <ul class="grid" id="posted-groups">
        <li class="group-card" data-university="University of Waterloo">
          <div class="group-meta">
            <div><strong>Class:</strong> CS135</div>
            <div><strong>University:</strong> University of Waterloo</div>
            <div><strong>Location:</strong> DP Library 3F</div>
            <div><strong>Time:</strong> Sep 18, 2025, 10:00–12:00</div>
            <div><strong>Max People:</strong> 4</div>
          </div>
          <button class="btn" disabled>Edit (coming soon)</button>
        </li>
        <li class="group-card" data-university="University of Toronto">
          <div class="group-meta">
            <div><strong>Class:</strong> CSC148</div>
            <div><strong>University:</strong> University of Toronto</div>
            <div><strong>Location:</strong> Bahen Centre Atrium</div>
            <div><strong>Time:</strong> Sep 22, 2025, 18:00–20:00</div>
            <div><strong>Max People:</strong> 5</div>
          </div>
          <button class="btn" disabled>Edit (coming soon)</button>
        </li>
      </ul>
    </section>

    <!-- Section for groups the user has joined -->
    <section class="card" style="margin-top: 2rem;">
      <h2>Groups I Joined</h2>
      <ul class="grid" id="joined-groups">
        <li class="group-card" data-university="University of Waterloo">
          <div class="group-meta">
            <div><strong>Class:</strong> MATH135</div>
            <div><strong>University:</strong> University of Waterloo</div>
            <div><strong>Location:</strong> MC Lounge</div>
            <div><strong>Time:</strong> Sep 20, 2025, 14:00–16:00</div>
            <div><strong>People:</strong> 3 / 5</div>
          </div>
          <button class="btn btn-primary" disabled>Leave Group</button>
        </li>
        <li class="group-card" data-university="University of Toronto">
          <div class="group-meta">
            <div><strong>Class:</strong> MAT135</div>
            <div><strong>University:</strong> University of Toronto</div>
            <div><strong>Location:</strong> Sidney Smith 2nd Floor</div>
            <div><strong>Time:</strong> Sep 25, 2025, 12:00–13:30</div>
            <div><strong>People:</strong> 2 / 4</div>
          </div>
          <button class="btn btn-primary" disabled>Leave Group</button>
        </li>
      </ul>
    </section>
  </main>

  <footer>
    <small>Later, this page will connect to the backend so your posted/joined groups appear here automatically.</small>
  </footer>

  <script>
    const UNIVERSITY_KEY = "sgfUniversity";
    const UNIVERSITY_LABEL_KEY = "sgfUniversityLabel";

    const savedUniversity = localStorage.getItem(UNIVERSITY_KEY);
    const savedUniversityLabel = localStorage.getItem(UNIVERSITY_LABEL_KEY) || savedUniversity;

    if (savedUniversityLabel) {
      document.getElementById("mygroups-university").textContent = savedUniversityLabel;
    }

    function filterGroups(listId) {
      const list = document.getElementById(listId);
      const items = Array.from(list.querySelectorAll(".group-card"));
      let visible = 0;

      items.forEach(item => {
        const matchesUniversity = savedUniversity ? item.dataset.university === savedUniversity : true;
        if (matchesUniversity) {
          item.style.display = "";
          visible += 1;
        } else {
          item.style.display = "none";
        }
      });

      if (!visible) {
        const message = document.createElement("li");
        message.textContent = `No groups yet at ${savedUniversityLabel || "your university"}.`;
        list.replaceChildren(message);
      }
    }

    filterGroups("posted-groups");
    filterGroups("joined-groups");
  </script>
</body>
</html>
